<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      i18n:domain="plone">

<body>

<tal:block i18n:domain="plone"
           metal:define-macro="portal_message">

<div id="plonePortalMessages">
    <dl class="portalMessage info" id="kssPortalMessage" style="display:none">
        <dt>Info</dt>
        <dd><tal:block replace="nothing">KSS portal message</tal:block></dd>
    </dl>
    <tal:statusmsg tal:define="messages python:context.plone_utils.showPortalMessages();
                               clouseau context/clouseau_tool/enabled | nothing"
                   tal:repeat="message messages">

        <dl class="portalMessage info"
            tal:define="mtype message/type | nothing;"
            tal:attributes="class string:portalMessage ${mtype};">
            <dt tal:content="python:mtype.capitalize()"
                i18n:translate="">
                Info
            </dt>
            <dd tal:define="msg message/message | nothing;
                            plominoerror python:test(' - Plomino formula ' in msg)">
                <span tal:condition="not:plominoerror" tal:content="msg"
	                i18n:translate="">
	                The status message.</span>
                <tal:block tal:condition="plominoerror"
                            tal:define="plomino_message python:msg.split(' - Plomino formula ');
                                        user_message python:plomino_message[0];
                                        formula_path python:plomino_message[-1];">
                    <span tal:content="user_message">
                        The status message.</span>
	                <a href="#" tal:condition="clouseau"
	                   class="ui-icon ui-icon-search"
	                   title="Launch debugger"
	                   tal:attributes="href string:javascript:debug_plomino('${here/absolute_url_path}', '${formula_path}')"
	                   >Debug</a>
                </tal:block>
            </dd>
        </dl>
    </tal:statusmsg>
</div>
</tal:block>

</body>
</html>
